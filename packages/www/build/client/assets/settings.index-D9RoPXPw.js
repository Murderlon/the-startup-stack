import{r as h,j as e}from"./jsx-runtime-BWtM72Fx.js";import{z as u}from"./index-BgCZZJbK.js";import{a as f,g as C}from"./misc-DExpcjDH.js";import{I as m}from"./misc-CKFZHWnt.js";import{u as j,g as R,p as v,a as N,b as w,I as A}from"./input-w4dflGK7.js";import{B as p}from"./button-DXLxMO3S.js";import{u as P,a as D,b as T,F}from"./components-Bhby6F3L.js";import{c as z}from"./createLucideIcon-B9RxcC_s.js";import"./index-DAw2iBXv.js";import"./index-DJR8etIf.js";/**
 * @license lucide-react v0.383.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=z("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);function O(){const[r,a]=h.useState(!1);function o(t){const l=()=>a(!1),n=r?void 0:i=>{i.preventDefault(),a(!0)},x=i=>{i.key==="Escape"&&a(!1)};return{...t,onBlur:f(l,t?.onBlur),onClick:f(n,t?.onClick),onKeyUp:f(x,t?.onKeyUp)}}return{doubleCheck:r,getButtonProps:o}}const _="/resources/upload-image",L=u.object({imageFile:u.instanceof(File).refine(r=>r.size>0,"Image is required.")}),q="/resources/reset-image",S=u.object({username:u.string().min(3).max(20).toLowerCase().trim().regex(/^[a-zA-Z0-9]+$/,"Username may only contain alphanumeric characters.")});function Q(){const{user:r}=P(),a=D(),[o,t]=h.useState(null),l=h.useRef(null),n=T(),x=T(),{doubleCheck:i,getButtonProps:k}=O(),[U,{username:d}]=j({lastResult:a,constraint:R(S),onValidate({formData:s}){return v(s,{schema:S})}}),[I,c]=j({lastResult:n.data,onValidate({formData:s}){return v(s,{schema:L})}});return e.jsxs("div",{className:"flex h-full w-full flex-col gap-6",children:[e.jsxs(n.Form,{method:"POST",action:_,encType:"multipart/form-data",ref:l,onReset:()=>t(null),...N(I),className:"flex w-full flex-col items-start rounded-lg border border-border bg-card",children:[e.jsxs("div",{className:"flex w-full items-start justify-between rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-medium text-primary",children:"Your Avatar"}),e.jsx("p",{className:"text-sm font-normal text-primary/60",children:"This is your avatar. It will be displayed on your profile."})]}),e.jsxs("label",{htmlFor:c.imageFile.id,className:"group relative flex cursor-pointer overflow-hidden rounded-full transition active:scale-95",children:[o||r.image?.id?e.jsx("img",{src:o??C(r.image?.id),className:"h-20 w-20 rounded-full object-cover",alt:r.username??r.email}):e.jsx("div",{className:"h-20 w-20 rounded-full bg-gradient-to-br from-lime-400 from-10% via-cyan-300 to-blue-500"}),e.jsx("div",{className:"absolute z-10 hidden h-full w-full items-center justify-center bg-primary/40 group-hover:flex",children:e.jsx(B,{className:"h-6 w-6 text-secondary"})})]}),e.jsx("input",{...w(c.imageFile,{type:"file"}),accept:"image/*",className:"peer sr-only",required:!0,tabIndex:o?-1:0,onChange:s=>{const g=s.currentTarget.files?.[0];if(g){const b=s.currentTarget.form;if(!b)return;const y=new FileReader;y.onload=E=>{t(E.target?.result?.toString()??null),n.submit(b)},y.readAsDataURL(g)}}})]}),e.jsxs("div",{className:"flex min-h-14 w-full items-center justify-between rounded-lg rounded-t-none border-t border-border bg-secondary px-6 dark:bg-card",children:[e.jsx("p",{className:"text-sm font-normal text-primary/60",children:"Click on the avatar to upload a custom one from your files."}),r.image?.id&&!c.imageFile.errors&&e.jsx(p,{type:"button",size:"sm",variant:"secondary",onClick:()=>{x.submit({},{method:"POST",action:q}),l.current&&l.current.reset()},children:"Reset"}),c.imageFile.errors&&e.jsx("p",{className:"text-right text-sm text-destructive dark:text-destructive-foreground",children:c.imageFile.errors.join(" ")})]})]}),e.jsxs(F,{method:"POST",className:"flex w-full flex-col items-start rounded-lg border border-border bg-card",...N(U),children:[e.jsxs("div",{className:"flex w-full flex-col gap-4 rounded-lg p-6",children:[e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("h2",{className:"text-xl font-medium text-primary",children:"Your Username"}),e.jsx("p",{className:"text-sm font-normal text-primary/60",children:"This is your username. It will be displayed on your profile."})]}),e.jsx(A,{placeholder:"Username",autoComplete:"off",defaultValue:r?.username??"",required:!0,className:`w-80 bg-transparent ${d.errors&&"border-destructive focus-visible:ring-destructive"}`,...w(d,{type:"text"})}),d.errors&&e.jsx("p",{className:"text-sm text-destructive dark:text-destructive-foreground",children:d.errors.join(" ")})]}),e.jsxs("div",{className:"flex min-h-14 w-full items-center justify-between rounded-lg rounded-t-none border-t border-border bg-secondary px-6 dark:bg-card",children:[e.jsx("p",{className:"text-sm font-normal text-primary/60",children:"Please use 32 characters at maximum."}),e.jsx(p,{type:"submit",size:"sm",name:m.INTENT,value:m.USER_UPDATE_USERNAME,children:"Save"})]})]}),e.jsxs("div",{className:"flex w-full flex-col items-start rounded-lg border border-destructive bg-card",children:[e.jsxs("div",{className:"flex flex-col gap-2 p-6",children:[e.jsx("h2",{className:"text-xl font-medium text-primary",children:"Delete Account"}),e.jsx("p",{className:"text-sm font-normal text-primary/60",children:"Permanently delete your Remix SaaS account, all of your projects, links and their respective stats."})]}),e.jsxs("div",{className:"flex min-h-14 w-full items-center justify-between rounded-lg rounded-t-none border-t border-border bg-red-500/10 px-6 dark:bg-red-500/10",children:[e.jsx("p",{className:"text-sm font-normal text-primary/60",children:"This action cannot be undone, proceed with caution."}),e.jsx(F,{method:"POST",children:e.jsx(p,{type:"submit",size:"sm",variant:"destructive",name:m.INTENT,value:m.USER_DELETE_ACCOUNT,...k(),children:i?"Are you sure?":"Delete Account"})})]})]})]})}export{Q as default};
